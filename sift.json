{
  "name":"carbon-footprint",
  "display-name":"Carbon Footprint Sift",
  "description":"",
  "author":"",
  "version":"1.0.0",
  "icon":"assets/airplane.svg",
  "interfaces":{
    "email":{
      "thread":{
        "controller":"dist/js/controller.umd-es2015.min.js"
      },
      "client":{
        "controller":"dist/js/email-client-controller.umd-es2015.min.js"
      }
    },
    "summary":{
      "controller":"dist/js/controller.umd-es2015.min.js"
    }
  },
  "dag":{
    "inputs":{
      "emails":{
        "britishAirways":{
          "filter":{
            "conditions":[
              {
                "from":{
                  "regexp":{
                    "pattern":".*@.*ba\\.com",
                    "flags":"i"
                  }
                }
              },
              {
                "conditions":[
                  {
                    "subject":{
                      "regexp":{
                        "pattern":".*ticket receipt.*",
                        "flags":"i"
                      }
                    }
                  },
                  {
                    "subject":{
                      "regexp":{
                        "pattern":".*boarding pass.*",
                        "flags":"i"
                      }
                    }
                  }
                ],
                "operator":"OR"
              },
              {
                "date":"between now and 1 year before now"
              }
            ],
            "operator":"AND"
          },
          "wants":[
            "archive",
            "textBody",
            "strippedHtmlBody"
          ]
        },
        "opodo":{
          "filter":{
            "conditions":[
              {
                "from":{
                  "regexp":{
                    "pattern":".*@opodo.*",
                    "flags":"i"
                  }
                }
              },
              {
                "subject":{
                  "regexp":{
                    "pattern":".*booking confirmation.*",
                    "flags":"i"
                  }
                }
              },
              {
                "date":"between now and 1 year before now"
              }
            ],
            "operator":"AND"
          },
          "wants":[
            "archive",
            "textBody",
            "strippedHtmlBody"
          ]
        },
        "lufthansa":{
          "filter":{
            "conditions":[
              {
                "from":{
                  "regexp":{
                    "pattern":".*@lufthansa\\.com",
                    "flags":"i"
                  }
                }
              },
              {
                "subject":{
                  "regexp":{
                    "pattern":".*boarding pass.*",
                    "flags":"i"
                  }
                }
              },
              {
                "date":"between now and 1 year before now"
              }
            ],
            "operator":"AND"
          },
          "wants":[
            "archive",
            "textBody",
            "strippedHtmlBody"
          ]
        },
        "easyjet":{
          "filter":{
            "conditions":[
              {
                "from":{
                  "regexp":{
                    "pattern":".*easyjet\\.com",
                    "flags":"i"
                  }
                }
              },
              {
                "subject":{
                  "regexp":{
                    "pattern":".*easyjet booking.*",
                    "flags":"i"
                  }
                }
              },
              {
                "date":"between now and 1 year before now"
              }
            ],
            "operator":"AND"
          },
          "wants":[
            "archive",
            "textBody",
            "strippedHtmlBody"
          ]
        }
      }
    },
    "nodes":[
      {
        "#":"British Airways Mapper",
        "implementation":{
          "javascript":"server/bawMapper.js"
        },
        "input":{
          "bucket":"britishAirways"
        },
        "outputs":{
          "routes":{

          },
          "flightNumbers":{

          }
        }
      },
      {
        "#":"Opodo Mapper",
        "implementation":{
          "javascript":"server/opodoMapper.js"
        },
        "input":{
          "bucket":"opodo"
        },
        "outputs":{
          "routes":{

          },
          "flightNumbers":{

          }
        }
      },
      {
        "#":"Lufthansa Mapper",
        "implementation":{
          "javascript":"server/lufthansaMapper.js"
        },
        "input":{
          "bucket":"lufthansa"
        },
        "outputs":{
          "routes":{

          },
          "flightNumbers":{

          }
        }
      },
      {
        "#":"EasyJet Mapper",
        "implementation":{
          "javascript":"server/easyjetMapper.js"
        },
        "input":{
          "bucket":"easyjet"
        },
        "outputs":{
          "flightNumbers":{

          }
        }
      },
      {
        "#":"Flight Mapper",
        "implementation":{
          "javascript":"server/flightMapper.js"
        },
        "input":{
          "bucket":"flightNumbers"
        },
        "shared":true,
        "outputs":{
          "routes":{

          }
        }
      },
      {
        "#":"Route Mapper",
        "implementation":{
          "javascript":"server/routeMapper.js"
        },
        "input":{
          "bucket":"routes",
          "select":"*"
        },
        "shared":true,
        "outputs":{
          "footprint":{

          },
          "history":{

          }
        }
      }
    ],
    "stores":{
      "flightNumbers":{
        "key$schema":"string"
      },
      "routes":{
        "key$schema":"string"
      }
    },
    "outputs":{
      "exports":{
        "footprint":{
          "key$schema":"string"
        },
        "history":{
          "key$schema":"string"
        }
      }
    }
  }
}